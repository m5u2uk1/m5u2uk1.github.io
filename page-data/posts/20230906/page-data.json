{"componentChunkName":"component---src-templates-post-template-post-template-tsx","path":"/posts/20230906/","result":{"data":{"markdownRemark":{"id":"72f5e428-a4c0-56a2-93ed-f0cca568ef0c","html":"<h2 id=\"きっかけ\" style=\"position:relative;\"><a href=\"#%E3%81%8D%E3%81%A3%E3%81%8B%E3%81%91\" aria-label=\"きっかけ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>きっかけ</h2>\n<p>Amazon Elastic Block Store 略して<a href=\"https://aws.amazon.com/jp/ebs/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">EBS</a>について説明を受けることがあったのですが、\n思うところがあり、まとめてみました。</p>\n<h2 id=\"ebsって何1行でまとめて\" style=\"position:relative;\"><a href=\"#ebs%E3%81%A3%E3%81%A6%E4%BD%951%E8%A1%8C%E3%81%A7%E3%81%BE%E3%81%A8%E3%82%81%E3%81%A6\" aria-label=\"ebsって何1行でまとめて permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>EBSって何？1行でまとめて</h2>\n<p>ざっくり簡単に言うと、<strong>EC2用追加ディスク</strong>です。</p>\n<p>ちょっとだけ細かいことをいうと、ブロックストレージ（ブロックデバイス）を提供するものです。<sup id=\"fnref-1\"><a href=\"#fn-1\" class=\"footnote-ref\">1</a></sup></p>\n<h2 id=\"block-ってなにさ\" style=\"position:relative;\"><a href=\"#block-%E3%81%A3%E3%81%A6%E3%81%AA%E3%81%AB%E3%81%95\" aria-label=\"block ってなにさ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Block ってなにさ</h2>\n<p>ブロックストレージとはブロックデバイスの1つです。ブロックデバイスというのはブロックという単位で読み書きをするデバイスのことです。\nブロックデバイスには他にもランダムアクセス可能、バッファの利用可能という特徴があって\n極論を言うとファイルシステムを利用できるデバイスと考えて頂ければと思います。<sup id=\"fnref-2\"><a href=\"#fn-2\" class=\"footnote-ref\">2</a></sup>。</p>\n<p>ここまで来れば、EBSって言葉は「EC2向けに用意された追加ディスク」を格好よく表現した感じだってわかってきます。恐れることはないです。</p>\n<h2 id=\"あれれなんで追加ディスクが必要なの\" style=\"position:relative;\"><a href=\"#%E3%81%82%E3%82%8C%E3%82%8C%E3%81%AA%E3%82%93%E3%81%A7%E8%BF%BD%E5%8A%A0%E3%83%87%E3%82%A3%E3%82%B9%E3%82%AF%E3%81%8C%E5%BF%85%E8%A6%81%E3%81%AA%E3%81%AE\" aria-label=\"あれれなんで追加ディスクが必要なの permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>あれれ？なんで追加ディスクが必要なの？</h2>\n<p>（別にEBSは必須ではありません。というのは置くとして）EC2 は AMI から生成されます。OS が動作するために必要なブロックデバイスはこの段階で用意されています。</p>\n<p>このブロックデバイスは EC2 のライフサイクルと同じで、EC2の終了/削除＝ディスクの終了/削除となります。EC2上にデータを保存しないシステムであればよいのですが\n既存のシステムはそんなこともないのでデータの保存場所に困るわけです。そこでEBSという話の筋書きになります。</p>\n<p>EC2上にデータを残したいと考えているなら、Amazon EFS とどちらか、用途・性能・コストを考えてを選択するのがお手軽な解決方法になるみたいですね。</p>\n<h3 id=\"おまけファイルシステムのブロックサイズ\" style=\"position:relative;\"><a href=\"#%E3%81%8A%E3%81%BE%E3%81%91%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%82%B7%E3%82%B9%E3%83%86%E3%83%A0%E3%81%AE%E3%83%96%E3%83%AD%E3%83%83%E3%82%AF%E3%82%B5%E3%82%A4%E3%82%BA\" aria-label=\"おまけファイルシステムのブロックサイズ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>おまけ：　ファイルシステムのブロックサイズ</h3>\n<p>Linuxで多く使用されているEXT4ファイルシステムの場合はブロックのサイズはデフォルトで4096KBになっています。\nEXT系ファイルシステムでブロックサイズを確認する方法は以下の通りです。XFSの場合はxfs_infoを実行するとよいです。</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">tune2fs /dev/sda1 <span class=\"token parameter variable\">-l</span>\ntune2fs <span class=\"token number\">1.46</span>.2 <span class=\"token punctuation\">(</span><span class=\"token number\">28</span>-Feb-2021<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">(</span>略<span class=\"token punctuation\">)</span>\nBlock size:               <span class=\"token number\">4096</span></code></pre></div>\n<h3 id=\"おまけebsの謎\" style=\"position:relative;\"><a href=\"#%E3%81%8A%E3%81%BE%E3%81%91ebs%E3%81%AE%E8%AC%8E\" aria-label=\"おまけebsの謎 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>おまけ：　EBSの謎</h3>\n<p>「Amazon」とついているサービスなので独立したサービスという位置付けですが、EBS は EC2 にしかアタッチできないですよね。\nベトベトに依存しているサービスにも見えます。なんでAWS EBSではないんだろう。謎。</p>\n<h3 id=\"記事を書く前でトラブル\" style=\"position:relative;\"><a href=\"#%E8%A8%98%E4%BA%8B%E3%82%92%E6%9B%B8%E3%81%8F%E5%89%8D%E3%81%A7%E3%83%88%E3%83%A9%E3%83%96%E3%83%AB\" aria-label=\"記事を書く前でトラブル permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>記事を書く前でトラブル。</h3>\n<p>内容をまとめるために手を動かそうとして、gatsby develop したら唐突のエラー。大して js を理解していないので\ncache と node_modules 消して再インストールすれば何とかなると思ってましたが大苦戦。\n同じタイミングで plugin の実装が変わってパラメータにnullが許されない制約がついたみたいで、\n原因と対処がとっちらかった模様。</p>\n<div class=\"footnotes\">\n<hr>\n<ol>\n<li id=\"fn-1\">というと、ブロックストレージ（ブロックデバイス）ってなんだよ？ってなるはず。<a href=\"#fnref-1\" class=\"footnote-backref\">↩</a></li>\n<li id=\"fn-2\">ブロック単位ではなく1文字1文字を先頭から順番に扱っていくキャラクターデバイスというのもありますが、ここでは割愛。<a href=\"#fnref-2\" class=\"footnote-backref\">↩</a></li>\n</ol>\n</div>","fields":{"slug":"/posts/20230906/","tagSlugs":["/tag/linux/","/tag/aws/"]},"frontmatter":{"date":"2023-09-06T19:00:00.000Z","description":"EBSでいうところのブロック、何だか知ってた？","tags":["Linux","AWS"],"title":"ブロックって何だか知ってた？","socialImage":{"publicURL":"/static/3e9fdb6f76e9e1b7ba50214287f07245/profile-pic.png"}}}},"pageContext":{"slug":"/posts/20230906/"}},"staticQueryHashes":["251939775","2764776372","401334301"],"slicesMap":{}}